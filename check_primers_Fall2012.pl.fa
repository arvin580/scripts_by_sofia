>#!/usr/bin/perl
-wNNNNNNNNNN
>use
strict;NNNNNNNNNN
>use
Data::Dumper;NNNNNNNNNN
>my
$fileNNNNNNNNNN=
>my
$db1NNNNNNNNNN=
>my
$db2NNNNNNNNNN=
>my
%students;NNNNNNNNNN
>my
%primers;NNNNNNNNNN
>if
(NNNNNNNNNN!defined
>
dieNNNNNNNNNN"please
>ClassSection
Student_nameNNNNNNNNNNTE_id
>ClassSection
Student_nameNNNNNNNNNNTE_id
>ClassSection
Student_nameNNNNNNNNNNTE_id
>";
NNNNNNNNNN
>}
NNNNNNNNNN
>
NNNNNNNNNN
>if
(NNNNNNNNNN!defined
>
dieNNNNNNNNNN"please
>";
NNNNNNNNNN
>}
NNNNNNNNNN
>if
(NNNNNNNNNN!defined
>
dieNNNNNNNNNN"please
>";
NNNNNNNNNN
>}
NNNNNNNNNN
>open
IN,NNNNNNNNNN$file
>open
OUT,NNNNNNNNNN">$file.flank.fa"
>open
OUTFlanktINNERNNNNNNNNNN,
>open
OUTINNER,NNNNNNNNNN">$file.inner.fa"
>
orNNNNNNNNNNdie
>
NNNNNNNNNN
>while
(NNNNNNNNNNmy
>
chompNNNNNNNNNN$line;
>
myNNNNNNNNNN(
>
ifNNNNNNNNNN(
>
$primers{$id}{p1}{seq}NNNNNNNNNN=
>
$primers{$id}{p2}{seq}NNNNNNNNNN=
>
$primers{$id}{p1}{len}NNNNNNNNNN=
>
$primers{$id}{p2}{len}NNNNNNNNNN=
>
myNNNNNNNNNN$seq_for_blast
>
$primers{$id}{student}=$student_name;NNNNNNNNNN
>
$students{$student_name}{complete}=0;NNNNNNNNNN
>
NNNNNNNNNN
>
printNNNNNNNNNNOUT
>
}NNNNNNNNNN
>
elsifNNNNNNNNNN(
>
$primers{$id}{p3}{seq}NNNNNNNNNN=
>
$primers{$id}{p3}{len}NNNNNNNNNN=
>
myNNNNNNNNNN$seq_for_blast
>
NNNNNNNNNN
>
printNNNNNNNNNNOUTINNER
>
printNNNNNNNNNNOUTFlanktINNER
>
}NNNNNNNNNN
>}
NNNNNNNNNN
>`blastall
-FNNNNNNNNNNF
>`blastall
-FNNNNNNNNNNF
>`blastall
-FNNNNNNNNNNF
>
NNNNNNNNNN
>open
BLASTOUT,NNNNNNNNNN"$file.flank.blastout"
>#14|TE
FlankNNNNNNNNNN2838|ZM_hAT_noncoding_5|padding|400|te|chr9:136082011..136082378|pcr|chr9:136081611..136082778
>
NNNNNNNNNN
>while
(NNNNNNNNNNmy
>
chompNNNNNNNNNN$line;
>
myNNNNNNNNNN(
>
$primer_pair,NNNNNNNNNN$desc,$subject,
>
$mm,NNNNNNNNNN$gapOpenings,
>
$sStart,NNNNNNNNNN$sEnd,
>
)NNNNNNNNNN=
>
$subjectNNNNNNNNNN=~
>
myNNNNNNNNNN$p1_len
>
myNNNNNNNNNN$p2_len
>
nextNNNNNNNNNNif
>
#nextNNNNNNNNNNif
>
nextNNNNNNNNNNif
>
ifNNNNNNNNNN(
>
(NNNNNNNNNN$sStart,
>
}NNNNNNNNNN
>
ifNNNNNNNNNN(
>
myNNNNNNNNNN$stored_start
>
myNNNNNNNNNN$stored_end
>
ifNNNNNNNNNN(
>
$primers{$primer_pair}{blast}{$subject}{sStart}NNNNNNNNNN=
>
}NNNNNNNNNN
>
ifNNNNNNNNNN(
>
$primers{$primer_pair}{blast}{$subject}{sEnd}NNNNNNNNNN=
>
}NNNNNNNNNN
>
}NNNNNNNNNN
>
elseNNNNNNNNNN{
>
$primers{$primer_pair}{blast}{$subject}{sStart}NNNNNNNNNN=
>
$primers{$primer_pair}{blast}{$subject}{sEnd}NNNNNNNNNN=
>
}NNNNNNNNNN
>
NNNNNNNNNN
>
$primers{$primer_pair}{blast}{$subject}{count}++;NNNNNNNNNN
>
$primers{$primer_pair}{blast}{$subject}{alnLen}NNNNNNNNNN=
>
$primers{$primer_pair}{blast}{$subject}{mm}NNNNNNNNNN=
>
$primers{$primer_pair}{blast}{$subject}{perID}NNNNNNNNNN=
>
$primers{$primer_pair}{blast}{$subject}{e}NNNNNNNNNN=
>
$primers{$primer_pair}{blast}{$subject}{line}NNNNNNNNNN=
>
$primers{$primer_pair}{subject}{$subject}NNNNNNNNNN=
>
$primers{$primer_pair}{inner}{$subject}{inner}NNNNNNNNNN=
>
NNNNNNNNNN
>}
NNNNNNNNNN
>
NNNNNNNNNN
>
NNNNNNNNNN
>open
BLASTOUT_flank_inner,NNNNNNNNNN"$file.flank_inner.blastout"
>
NNNNNNNNNN
>while
(NNNNNNNNNNmy
>
chompNNNNNNNNNN$line;
>
myNNNNNNNNNN(
>
$primer_pair,NNNNNNNNNN$desc,$subject,
>
$mm,NNNNNNNNNN$gapOpenings,
>
$sStart,NNNNNNNNNN$sEnd,
>
)NNNNNNNNNN=
>
$subjectNNNNNNNNNN=~
>
myNNNNNNNNNN$p1_len
>
myNNNNNNNNNN$p2_len
>
nextNNNNNNNNNNif
>
nextNNNNNNNNNNif
>
ifNNNNNNNNNN(
>
(NNNNNNNNNN$sStart,
>
}NNNNNNNNNN
>
ifNNNNNNNNNN(
>
myNNNNNNNNNN$stored_start
>
myNNNNNNNNNN$stored_end
>
ifNNNNNNNNNN(
>
$primers{$primer_pair}{inner}{$subject}{sStart}NNNNNNNNNN=
>
}NNNNNNNNNN
>
ifNNNNNNNNNN(
>
$primers{$primer_pair}{inner}{$subject}{sEnd}NNNNNNNNNN=
>
}NNNNNNNNNN
>
}NNNNNNNNNN
>
elseNNNNNNNNNN{
>
$primers{$primer_pair}{inner}{$subject}{sStart}NNNNNNNNNN=
>
$primers{$primer_pair}{inner}{$subject}{sEnd}NNNNNNNNNN=
>
}NNNNNNNNNN
>
NNNNNNNNNN
>
$primers{$primer_pair}{inner}{$subject}{count}++;NNNNNNNNNN
>
$primers{$primer_pair}{inner}{$subject}{alnLen}NNNNNNNNNN=
>
$primers{$primer_pair}{inner}{$subject}{mm}NNNNNNNNNN=
>
$primers{$primer_pair}{inner}{$subject}{perID}NNNNNNNNNN=
>
$primers{$primer_pair}{inner}{$subject}{e}NNNNNNNNNN=
>
$primers{$primer_pair}{inner}{$subject}{line}NNNNNNNNNN=
>
NNNNNNNNNN
>}
NNNNNNNNNN
>
NNNNNNNNNN
>
NNNNNNNNNN
>open
BLASTOUT_inner,NNNNNNNNNN"$file.inner.blastout"
>
orNNNNNNNNNNdie
>
NNNNNNNNNN
>#14|TE
InnerNNNNNNNNNN2834|ZM_hAT_noncoding_5|methyl|chr8:29147579..29147766|complete|chr8:29147384..29147766
>while
(NNNNNNNNNNmy
>
chompNNNNNNNNNN$line;
>
myNNNNNNNNNN(
>
$primer_pair,NNNNNNNNNN$desc,
>
$mm,NNNNNNNNNN$gapOpenings,
>
$sStart,NNNNNNNNNN$sEnd,
>
)NNNNNNNNNN=
>
$subjectNNNNNNNNNN=~
>
myNNNNNNNNNN$p3_len
>
nextNNNNNNNNNNif
>
nextNNNNNNNNNNif
>
ifNNNNNNNNNN(exists
>
#doesNNNNNNNNNNthe
>
$primers{$primer_pair}{inner}{$subject}{inner}NNNNNNNNNN=1
>
}NNNNNNNNNN
>
}NNNNNNNNNN
>
NNNNNNNNNN
>print
NNNNNNNNNN
>"name\tprimer_set\thit\tflank_product_size\tinner_product_size\tcorrect_hit\tcorrect_inner\tp1\tp2\tp3\n";
NNNNNNNNNN
>
myNNNNNNNNNN$student_count
>my
$to_print;NNNNNNNNNN
>foreach
myNNNNNNNNNN$primer_set
>
foreachNNNNNNNNNNmy
>
myNNNNNNNNNN%hits;
>
myNNNNNNNNNN@values;
>
myNNNNNNNNNN@lines;
>
myNNNNNNNNNN($loc)
>
myNNNNNNNNNN$correct_matches
>
myNNNNNNNNNN$correct_inner
>
myNNNNNNNNNN$count
>
ifNNNNNNNNNN(
>
$correct_matchesNNNNNNNNNN=
>
}NNNNNNNNNN
>
ifNNNNNNNNNN(
>
{NNNNNNNNNN#1=correct
>
$correct_innerNNNNNNNNNN=
>
}NNNNNNNNNN
>
myNNNNNNNNNN$flank_start
>
myNNNNNNNNNN$flank_end
>
myNNNNNNNNNN$inner_end
>
myNNNNNNNNNN$p1
>
myNNNNNNNNNN$p2
>
myNNNNNNNNNN$p3
>
myNNNNNNNNNN$flank_product_size
>
$correct_matchesNNNNNNNNNNeq
>
myNNNNNNNNNN$inner_product_size
>
$correct_innerNNNNNNNNNNeq
>
myNNNNNNNNNN$in_range
>
myNNNNNNNNNN($actual_loc)
>#print
DumperNNNNNNNNNN\%primers;
>
ifNNNNNNNNNN(
>
$in_rangeNNNNNNNNNN=
>
}NNNNNNNNNN
>
myNNNNNNNNNN$name
>
ifNNNNNNNNNN($correct_matches
>
printNNNNNNNNNN
>"$name\t$primer_set\t$sub\t$flank_product_size\t$inner_product_size\t$in_range\t$correct_inner\t$p1\t$p2\t$p3\n";
NNNNNNNNNN
>
}elsifNNNNNNNNNN($in_range
>
printNNNNNNNNNN
>"$name\t$primer_set\t$sub\t$flank_product_size\t(incorrectMatchNumber=$count)\t$in_range\t$correct_inner\t$p1\t$p2\t$p3\n";
NNNNNNNNNN
>
$students{$name}{err}{flank}="theNNNNNNNNNN2
>
NNNNNNNNNN
>
}NNNNNNNNNN
>
ifNNNNNNNNNN(($correct_matches
>
myNNNNNNNNNN$line
>
$to_printNNNNNNNNNN.=
>
$students{$name}{complete}=1;NNNNNNNNNN
>
}NNNNNNNNNN
>
NNNNNNNNNN
>
}NNNNNNNNNN
>}
NNNNNNNNNN
>print
"\n\nstudent_count\t$student_count\n";NNNNNNNNNN
>print
"\n\n$to_print\n";NNNNNNNNNN
>foreach
myNNNNNNNNNN$name
>
myNNNNNNNNNN$complete
>
myNNNNNNNNNN$err_flank;
>
ifNNNNNNNNNN(exists
>
$err_flankNNNNNNNNNN=
>
}NNNNNNNNNN
>
printNNNNNNNNNN"$name\t$err_flank\tp1\t-\n$name\t$err_flank\tp2\t-\n$name\t\tp3\t-\n"
>}
NNNNNNNNNN
